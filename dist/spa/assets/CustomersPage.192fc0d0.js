import{_ as ce,r as o,c as U,w as oe,o as se,l as v,v as B,n,d as a,aB as le,A as b,q as d,t as ve,u as pe,aG as m,M as Q,bj as _e,aA as fe,b as be,bk as Ce,b5 as he,aD as ye,aE as we,m as R,x as _,F as ge,Q as A}from"./index.84e406f6.js";import{Q as M}from"./QTable.45c07f07.js";import{u as re}from"./use-quasar.eb8135c3.js";import{Q as ne}from"./QSpinnerFacebook.317364b6.js";import{u as de}from"./axios.95677817.js";import{e as ke}from"./exportToExcel.7a526dc2.js";import{Q as xe}from"./TouchPan.2db7e4a4.js";import{Q as te}from"./QSelect.c660601d.js";import{Q as De}from"./QScrollArea.83c641f4.js";import{Q as Se}from"./QForm.48a1f013.js";import{u as Ve}from"./general.26e1389d.js";import"./QList.c2d242fe.js";import"./QMarkupTable.f3df12e7.js";import"./FileSaver.min.0ff652e7.js";import"./touch.3df10340.js";import"./format.caa0d1be.js";import"./QResizeObserver.d83a6f29.js";import"./QScrollObserver.3e0dacf6.js";const c=P=>(ye("data-v-5a034c66"),P=P(),we(),P),Le=c(()=>d("div",{class:"text-h6 text-bold",style:{color:"#123499"}}," Edit Customer Details ",-1)),Ne={class:"text-bold"},qe={class:"text-green"},Fe=c(()=>d("div",{class:"text-bold q-mt-md"},"Name of the Bank",-1)),Te=c(()=>d("div",{class:"text-bold q-mt-md"},"Bank Account Number",-1)),Ue=c(()=>d("div",{class:"text-bold q-mt-md"},"Name as in Bank",-1)),Be=c(()=>d("div",{class:"text-bold q-mt-md"},"Bank Branch",-1)),Pe=c(()=>d("div",{class:"text-bold q-mt-md"},"IFSC Code",-1)),Ae=c(()=>d("div",{class:"text-bold q-mt-md"},"City",-1)),Ee=c(()=>d("div",{class:"text-bold q-mt-md"},"Town",-1)),Ie=c(()=>d("div",{class:"text-bold q-mt-md"},"State",-1)),$e=c(()=>d("div",{class:"text-bold q-mt-md"},"District",-1)),Oe=c(()=>d("div",{class:"text-bold q-mt-md"},"Address",-1)),Qe=c(()=>d("div",{class:"text-bold q-mt-md"},"Pin Code",-1)),Re=c(()=>d("div",{class:"text-bold q-mt-md"},"User Status",-1)),Me={__name:"editCustomerDetailsModal",props:{showEditCustomerPopup:{type:Boolean,required:!0,default:!1},closeEditCustomerPopup:{type:Function,required:!0},selectedData:{type:Object,required:!0}},setup(P){const s=P,E=Ve(),ae=de(),p=o(s.selectedData[0].account_number),C=o(s.selectedData[0].bank_branch),h=o(s.selectedData[0].ifsc_code),y=o(s.selectedData[0].name_of_bank),w=o(s.selectedData[0].name_as_in_bank),g=o(s.selectedData[0].city),u=o(s.selectedData[0].town),k=o(s.selectedData[0].address),x=o(s.selectedData[0].pin_code),N=o([]),D=o(s.selectedData[0].state),q=o([]),f=o(""),F=o(s.selectedData[0].user_status),S=re(),T=U({get:()=>s.showEditCustomerPopup,set:()=>s.closeEditCustomerPopup()}),I=U(()=>{var e;return(e=N.value)==null?void 0:e.map(l=>l.name)}),j=U(()=>{var e;return(e=q.value)==null?void 0:e.map(l=>l.name)}),G=U(()=>["Active","Inactive"]),K=U(()=>{var l;return((l=N.value)==null?void 0:l.find(t=>t.name==D.value)).uid}),Z=U(()=>{var l;return((l=q.value)==null?void 0:l.find(t=>t.name==f.value)).id}),V=U(()=>{let e=i(y.value),l=i(p.value),t=i(w.value),X=i(C.value),ee=$(h.value),Y=i(g.value),ue=i(u.value),ie=i(k.value),me=H(x.value);return!t||!X||!ee||!Y||!ue||!ie||!me||!l||!e}),L=()=>{S.loading.show({spinner:ne,spinnerColor:"light-blue",messageColor:"white",backgroundColor:"light-blue",message:""})},z=()=>{S.loading.hide()},$=e=>/^[A-Z]{4}0([A-Z0-9]{6})$/.test(e.toUpperCase()),H=e=>e.toString().length==6,O=e=>{s.closeEditCustomerPopup(e)},J=()=>{E.getAllStates().then(e=>{N.value=e.data,W()})},W=()=>{f.value="";let e={stateUid:K.value};E.getDistrictsForState(e).then(l=>{q.value=l.data,f.value=l.data[0].name})},i=e=>e.trim().length>2,r=()=>{L();let e={customerUid:s.selectedData[0].customer_uid,bankName:y.value,bankAccountNumber:p.value,nameAsInBank:w.value,bankBranch:C.value,ifscCode:h.value,city:g.value,town:u.value,address:k.value,pinCode:x.value,userStatus:F.value,district:Z.value};ae.updateCustomerDetails(e).then(l=>{S.notify({message:"Customer Details Updated Successfully!!!",type:"positive",position:"top"}),O(!0)}).catch(l=>{S.notify({message:"Error in updating customer details. Please contact your admin!!!",type:"negative",position:"top"})}).finally(()=>{z()})};return oe(D,e=>{W()}),se(()=>{J()}),(e,l)=>(v(),B(he,{modelValue:Q(T),"onUpdate:modelValue":l[12]||(l[12]=t=>be(T)?T.value=t:null),persistent:"",onKeydown:Ce(O,["esc"])},{default:n(()=>[a(fe,{class:"customer-modal"},{default:n(()=>[a(le,{class:"row items-center"},{default:n(()=>[Le,a(xe),a(b,{icon:"close",flat:"",round:"",onClick:O})]),_:1}),a(Se,{onSubmit:r},{default:n(()=>[a(De,{style:{height:"calc(95vh - 170px)"}},{default:n(()=>[a(le,null,{default:n(()=>[d("div",Ne,[ve(" Customer - "),d("span",qe,pe(`${s.selectedData[0].name} - ${s.selectedData[0].customer_number}`),1)]),Fe,a(m,{modelValue:y.value,"onUpdate:modelValue":l[0]||(l[0]=t=>y.value=t),style:{"max-width":"350px"},outlined:"",dense:"",autofocus:"",placeholder:"Enter name of the Bank",maxlength:"128",rules:[t=>i(t)||"Field is required!!!"]},null,8,["modelValue","rules"]),Te,a(m,{modelValue:p.value,"onUpdate:modelValue":l[1]||(l[1]=t=>p.value=t),style:{"max-width":"350px"},outlined:"",dense:"",autofocus:"",placeholder:"Enter an account number",maxlength:"64",onkeypress:"return event.charCode >= 48 && event.charCode <= 57",rules:[t=>i(t)||"Field is required!!!"]},null,8,["modelValue","rules"]),Ue,a(m,{modelValue:w.value,"onUpdate:modelValue":l[2]||(l[2]=t=>w.value=t),style:{"max-width":"350px"},outlined:"",dense:"",autofocus:"",placeholder:"Enter name as in bank",maxlength:"256",rules:[t=>i(t)||"Field is required!!!"]},null,8,["modelValue","rules"]),Be,a(m,{modelValue:C.value,"onUpdate:modelValue":l[3]||(l[3]=t=>C.value=t),style:{"max-width":"350px"},outlined:"",dense:"",autofocus:"",placeholder:"Enter a bank branch name",maxlength:"128",rules:[t=>i(t)||"Field is required!!!"]},null,8,["modelValue","rules"]),Pe,a(m,{modelValue:h.value,"onUpdate:modelValue":l[4]||(l[4]=t=>h.value=t),style:{"max-width":"350px"},outlined:"",dense:"",autofocus:"",placeholder:"Enter a IFSC code",maxlength:"11",rules:[t=>$(t)||"Enter a Valid IFSC Code!!!"]},null,8,["modelValue","rules"]),Ae,a(m,{modelValue:g.value,"onUpdate:modelValue":l[5]||(l[5]=t=>g.value=t),style:{"max-width":"350px"},outlined:"",dense:"",autofocus:"",placeholder:"Enter a City",maxlength:"128",rules:[t=>i(t)||"Field is required!!!"]},null,8,["modelValue","rules"]),Ee,a(m,{modelValue:u.value,"onUpdate:modelValue":l[6]||(l[6]=t=>u.value=t),style:{"max-width":"350px"},outlined:"",dense:"",autofocus:"",placeholder:"Enter a Town",maxlength:"128",rules:[t=>i(t)||"Field is required!!!"]},null,8,["modelValue","rules"]),Ie,a(te,{style:{width:"350px"},filled:"",modelValue:D.value,"onUpdate:modelValue":l[7]||(l[7]=t=>D.value=t),options:Q(I)},null,8,["modelValue","options"]),$e,a(te,{style:{width:"350px"},filled:"",modelValue:f.value,"onUpdate:modelValue":l[8]||(l[8]=t=>f.value=t),options:Q(j)},null,8,["modelValue","options"]),Oe,a(m,{modelValue:k.value,"onUpdate:modelValue":l[9]||(l[9]=t=>k.value=t),type:"textarea",style:{width:"350px"},outlined:"",dense:"",autofocus:"",rows:"2","input-class":"textarea-input",placeholder:"Enter an Address",rules:[t=>i(t)||"Field is required!!!"]},null,8,["modelValue","rules"]),Qe,a(m,{modelValue:x.value,"onUpdate:modelValue":l[10]||(l[10]=t=>x.value=t),style:{"max-width":"350px"},outlined:"",dense:"",autofocus:"",placeholder:"Enter the Pincode",maxlength:"6",onkeypress:"return event.charCode >= 48 && event.charCode <= 57",rules:[t=>H(t)||"Enter a valid Pincode!!!"]},null,8,["modelValue","rules"]),Re,a(te,{style:{width:"350px"},filled:"",modelValue:F.value,"onUpdate:modelValue":l[11]||(l[11]=t=>F.value=t),options:Q(G)},null,8,["modelValue","options"])]),_:1})]),_:1}),a(le,{class:"row justify-end"},{default:n(()=>[a(_e,{class:"q-px-none"},{default:n(()=>[a(b,{unelevated:"",color:"primary",label:"Save",disable:Q(V),type:"submit","no-caps":""},null,8,["disable"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeydown"]))}};var je=ce(Me,[["__scopeId","data-v-5a034c66"]]);const Ge={style:{"margin-top":"30px"},class:"q-ml-md q-mr-lg q-pa-md"},Ke={class:"row justify-start items-center"},Ze=d("span",{class:"q-ml-sm"},null,-1),ze={key:0,class:"q-ml-md q-mr-lg q-pa-md"},He={key:1,class:"q-ml-md q-mr-lg q-pa-md"},Je={key:2,class:"q-ml-md q-mr-lg q-pa-md"},We={key:3,class:"q-ml-md q-mr-lg q-pa-md"},fl={__name:"CustomersPage",setup(P){const s=de(),E=re(),p=o([{name:"name",required:!0,label:"Customer name",align:"left",field:r=>r.name,format:r=>`${r}`,sortable:!0},{name:"customerNumber",label:"Customer Number",field:"customer_number",sortable:!0},{name:"dob",label:"Date of birth",field:"date_of_birth"},{name:"gender",label:"Gender",field:"gender"},{name:"plan",label:"Plan Name",field:"plan"},{name:"planStartDate",label:"Customer Registration Date",field:"plan_start_date",sortable:!0},{name:"mobileNumber",label:"Mobile Number",field:"mobile_number"},{name:"nomineeName",label:"Nominee Name",field:"nominee_name"},{name:"aadharNumber",label:"Aadhar Number",field:"aadhar_number"},{name:"pan",label:"PAN",field:"pan"},{name:"city",label:"City",field:"city"},{name:"town",label:"Town",field:"town"},{name:"district",label:"District",field:"district",sortable:!0},{name:"state",label:"State",field:"state",sortable:!0},{name:"address",label:"Address",field:"address"},{name:"pinCode",label:"Pin Code",field:"pin_code"},{name:"nameOfBank",label:"Name of Bank",field:"name_of_bank"},{name:"nameAsInBank",label:"Name as in Bank",field:"name_as_in_bank"},{name:"ifscCode",label:"IFSC Code",field:"ifsc_code"},{name:"bankBranch",label:"Bank Branch",field:"bank_branch"},{name:"accountNumber",label:"Account Number",field:"account_number"},{name:"referrerId",label:"Referrrer Id",field:"referrer_id"},{name:"referrerName",label:"Referrer Name",field:"referrer_name"},{name:"orderNumber",label:"Order Number",field:"order_number"},{name:"productName",label:"Product Name",field:"product_name"},{name:"deliveryThrough",label:"Courier Name",field:"delivery_through"},{name:"deliveryNumber",label:"Courier Number",field:"delivery_number"},{name:"courierDate",label:"Courier Date",field:"courier_date"},{name:"deliveryDate",label:"Delivery Date",field:"delivery_date"},{name:"orderStatus",label:"Courier Status",field:"order_status",sortable:!0},{name:"paymentDate",label:"Payment Date",field:"payment_date"},{name:"paymentMode",label:"Payment Mode",field:"payment_mode"},{name:"paymentReference",label:"Payment Reference",field:"payment_reference"},{name:"paymentStatus",label:"Payment Status",field:"payment_status",sortable:!0},{name:"levelOneCount",label:"Level One Count",field:"level_one_count"},{name:"levelOneCompleted",label:"Level One Status",field:"level_one_completed",sortable:!0},{name:"levelOneCompletedDate",label:"Level One Completed Date",field:"level_one_completed_date"},{name:"levelOneCommission",label:"Level One Commission",field:"level_one_commission_status",sortable:!0},{name:"levelTwoCount",label:"Level Two Count",field:"level_two_count"},{name:"levelTwoCompleted",label:"Level Two Status",field:"level_two_completed",sortable:!0},{name:"levelTwoCompletedDate",label:"Level Two Completed Date",field:"level_two_completed_date"},{name:"levelTwoCommission",label:"Level Two Commission",field:"level_two_commission_status",sortable:!0},{name:"levelThreeCount",label:"Level Three Count",field:"level_three_count"},{name:"levelThreeCompleted",label:"Level Three Status",field:"level_three_completed",sortable:!0},{name:"levelThreeCompletedDate",label:"Level Three Completed Date",field:"level_three_completed_date"},{name:"levelThreeCommission",label:"Level Three Commission",field:"level_three_commission_status",sortable:!0},{name:"levelFourCount",label:"Level Four Count",field:"level_four_count"},{name:"levelFourCompleted",label:"Level Four Status",field:"level_four_completed",sortable:!0},{name:"levelFourCompletedDate",label:"Level Four Completed Date",field:"level_four_completed_date"},{name:"levelFourCommission",label:"Level Four Commission",field:"level_four_commission_status",sortable:!0},{name:"userStatus",label:"User Status",field:"user_status",sortable:!0}]),C=o([]),h=o([]),y=o([]),w=o([]),g=o([]),u=o([]),k=o(""),x=o(""),N=o(""),D=o(""),q=o(""),f=o(!1),F=o(!1),S=o(!1),T=o(!1),I=o(!1),j=o(""),G=o(""),K=o(""),Z=o(""),V=o(!1),L=o(!1),z=()=>{E.loading.show({spinner:ne,spinnerColor:"light-blue",messageColor:"white",backgroundColor:"light-blue",message:""})},$=()=>{E.loading.hide()},H=()=>{L.value=!0},O=r=>{L.value=!1,r===!0&&(u.value=[],J())},J=()=>{z(),s.getCustomersList().then(r=>{let e=r.data,l=[];for(let t of e){let X=t.order_details[0],ee=X.order_items[0];delete t.order_details;let Y={...t,...X,...ee};delete Y.order_items,l.push(Y)}C.value=l}).catch(r=>{console.log("errror",r)}).finally(()=>{$()})},W=()=>{z();let r=u.value[0].uid;j.value=`First Level Customers Under ${u.value[0].name}`,G.value=`Second Level Customers Under ${u.value[0].name}`,K.value=`Third Level Customers Under ${u.value[0].name}`,Z.value=`Fourth Level Customers Under ${u.value[0].name}`,s.getCustomerDetails(r).then(e=>{let l=e.data;h.value=l.first_level_customers,y.value=l.second_level_customers,w.value=l.third_level_customers,g.value=l.fourth_level_customers,V.value=!0}).catch(e=>{console.log("error",e)}).finally(()=>{$()})},i=()=>{let r=[];for(let e of C.value){let l={"Customer Name":e.name,"Customer Number":e.customer_number,"Date of Birth":e.date_of_birth,Gender:e.gender,"Plan Name":e.plan,"Customer Registration Date":e.plan_start_date,"Mobile Number":e.mobile_number,"Nominee Name":e.nominee_name,"Aadhar Name":e.aadhar_number,PAN:e.pan,City:e.city,Town:e.town,District:e.district,State:e.state,Address:e.address,"Pin Code":e.pin_code,"Name of Bank":e.name_of_bank,"Name as in Bank":e.name_as_in_bank,"IFSC Code":e.ifsc_code,"Bank Branch":e.bank_branch,"Account Number":e.account_number,"Referrer Id":e.referrer_id,"Referrer Name":e.referrer_name,"Order Number":e.order_number,"Product Name":e.product_name,"Courier Name":e.delivery_through,"Courier Number":e.delivery_number,"Courier Date":e.courier_date,"Delivery Date":e.delivery_date,"Courier Status":e.order_status,"Payment Date":e.payment_date,"Payment Mode":e.payment_mode,"Payment Reference":e.payment_reference,"Payment Status":e.payment_status,"Level One Count":e.level_one_count,"Level One Status":e.level_one_completed,"Level One Completed Date":e.level_one_completed_date,"Level One Commission":e.level_one_commission_status,"Level Two Count":e.level_two_count,"Level Tow Status":e.level_two_completed,"Level Two Completed Date":e.level_two_completed_date,"Level Two Commission":e.level_two_commission_status,"Level Three Count":e.level_three_count,"Level Three Status":e.level_three_completed,"Level Three Completed Date":e.level_three_completed_date,"Level Three Commission":e.level_three_commission_status,"Level Four Count":e.level_four_count,"Level Four Status":e.level_four_completed,"Level Four Completed Date":e.level_four_completed_date,"Level Four Commission":e.level_four_commission_status,"User Status":e.user_status};r.push(l)}ke(r,"customers.xlsx")};return oe(u,r=>{r.length?W():(h.value=[],y.value=[],w.value=[],g.value=[],V.value=!1)}),se(()=>{J()}),(r,e)=>(v(),R(ge,null,[d("div",Ge,[a(b,{color:"green",class:"q-mb-md",style:{width:"20px"},"no-caps":"",onClick:i},{default:n(()=>[d("div",Ke,[a(A,{name:"fas fa-file-excel"}),Ze])]),_:1}),a(M,{class:"customers-table",flat:"",bordered:"",title:"Customers",rows:C.value,columns:p.value,"row-key":"name",selection:"single",selected:u.value,"onUpdate:selected":e[2]||(e[2]=l=>u.value=l),filter:k.value},{"top-right":n(()=>[f.value?(v(),B(m,{key:0,filled:"",borderless:"",dense:"",debounce:"300",modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=l=>k.value=l),placeholder:"Search"},{append:n(()=>[a(A,{name:"search"})]),_:1},8,["modelValue"])):_("",!0),a(b,{class:"q-ml-sm",icon:"filter_list",onClick:e[1]||(e[1]=l=>f.value=!f.value),flat:""})]),_:1},8,["rows","columns","selected","filter"]),a(b,{class:"q-mt-md",color:"primary",label:"Edit",disable:!u.value.length,onClick:H},null,8,["disable"])]),V.value?(v(),R("div",ze,[a(M,{class:"customers-table",flat:"",bordered:"",title:j.value,rows:h.value,columns:p.value,"row-key":"name",filter:x.value},{"top-right":n(()=>[F.value?(v(),B(m,{key:0,filled:"",borderless:"",dense:"",debounce:"300",modelValue:x.value,"onUpdate:modelValue":e[3]||(e[3]=l=>x.value=l),placeholder:"Search"},{append:n(()=>[a(A,{name:"search"})]),_:1},8,["modelValue"])):_("",!0),a(b,{class:"q-ml-sm",icon:"filter_list",onClick:e[4]||(e[4]=l=>F.value=!F.value),flat:""})]),_:1},8,["title","rows","columns","filter"])])):_("",!0),V.value?(v(),R("div",He,[a(M,{class:"customers-table",flat:"",bordered:"",title:G.value,rows:y.value,columns:p.value,"row-key":"name",filter:N.value},{"top-right":n(()=>[S.value?(v(),B(m,{key:0,filled:"",borderless:"",dense:"",debounce:"300",modelValue:N.value,"onUpdate:modelValue":e[5]||(e[5]=l=>N.value=l),placeholder:"Search"},{append:n(()=>[a(A,{name:"search"})]),_:1},8,["modelValue"])):_("",!0),a(b,{class:"q-ml-sm",icon:"filter_list",onClick:e[6]||(e[6]=l=>S.value=!S.value),flat:""})]),_:1},8,["title","rows","columns","filter"])])):_("",!0),V.value?(v(),R("div",Je,[a(M,{class:"customers-table",flat:"",bordered:"",title:K.value,rows:w.value,columns:p.value,"row-key":"name",filter:D.value},{"top-right":n(()=>[T.value?(v(),B(m,{key:0,filled:"",borderless:"",dense:"",debounce:"300",modelValue:D.value,"onUpdate:modelValue":e[7]||(e[7]=l=>D.value=l),placeholder:"Search"},{append:n(()=>[a(A,{name:"search"})]),_:1},8,["modelValue"])):_("",!0),a(b,{class:"q-ml-sm",icon:"filter_list",onClick:e[8]||(e[8]=l=>T.value=!T.value),flat:""})]),_:1},8,["title","rows","columns","filter"])])):_("",!0),V.value?(v(),R("div",We,[a(M,{class:"customers-table",flat:"",bordered:"",title:Z.value,rows:g.value,columns:p.value,"row-key":"name",filter:q.value},{"top-right":n(()=>[I.value?(v(),B(m,{key:0,filled:"",borderless:"",dense:"",debounce:"300",modelValue:q.value,"onUpdate:modelValue":e[9]||(e[9]=l=>q.value=l),placeholder:"Search"},{append:n(()=>[a(A,{name:"search"})]),_:1},8,["modelValue"])):_("",!0),a(b,{class:"q-ml-sm",icon:"filter_list",onClick:e[10]||(e[10]=l=>I.value=!I.value),flat:""})]),_:1},8,["title","rows","columns","filter"])])):_("",!0),L.value?(v(),B(je,{key:4,modelValue:L.value,"onUpdate:modelValue":e[11]||(e[11]=l=>L.value=l),"show-edit-customer-popup":L.value,"close-edit-customer-popup":O,"selected-data":u.value},null,8,["modelValue","show-edit-customer-popup","selected-data"])):_("",!0)],64))}};export{fl as default};
